#!/usr/bin/env bash

[ "$DEBUG" = "1" ] && set -x

DOTFILES_ROOT="$( cd "$(dirname $(dirname "$0"))" ; pwd -P )"
cd $DOTFILES_ROOT

FPATH="$DOTFILES_ROOT/functions:$FPATH"

# Generate a "Machine Name"
MACHINE_NAME=$(hostname)
if uname -r | grep "Microsoft" >/dev/null; then
    export MACHINE_NAME="$MACHINE_NAME-wsl"
fi

# Set up software using Homebrew
echo -e "\e[35m=== Running ./brew/install.sh ... ===\e[0m"
"$DOTFILES_ROOT/brew/install.sh"

# Launch stage 2, which should launch in ZSH if available
exec "$DOTFILES_ROOT/script/setup-stage2.zsh"